---
title: 一入vim深似海，从此鼠标成路人
date: 2017-04-10 13:00:39
tags: 编辑器
---

[VIM维基](https://zh.wikipedia.org/wiki/Vim)

[TOC]

# 安装 Vim

```
sudo apt install Vim
```

or

```
sudo apt-get install Vim
```

Vim 有内嵌一个教程小程序 

```
Vimtutor
```

在命令行输入 Vimtutor 就可以出现这个教程页面了。 英语不好的我， 则是看看晚上的教程。

# Vim 的三种模式

*  交互模式 : Interactif Mode 。 这是 Vim 的默认模式， 在打开 Vim 之后就是这个模式，这个模式中不能编辑文本， 最好也别乱按， 否则会导致触发其他相应的操作。

*  插入模式 : Insert Mode 。 进入这个模式就是文本编辑的页面， 会出现光标； 进入这个模式有集中方式， 最常用的就是按字母 "i", ( i 是insert的首字母， 插入的意思 )。 退出这个模式 按下 "Esc" 即可退出。

*  命令模式 : Command Mode 。 这个模式下， 可以运行一些命令， 例如 退出、保存等等； 也可以用这个模式来激活一些 Vim 的配置 ( 例如语法高亮、显示行号等等 )； 甚至还可以发一些命令给终端命令行， 例如 ls, locate, cp等等。进入这个模式， 首先要处于交互模式下， 然后按下冒号 ( 在一般的键盘上是要按下 Shift 键 + 分号键 ）。 输入命令后， 再按回车， 就会执行此命令。 执行命令后， 就又回到交互模式了。

> 总有一天你会明白 **" 一入 Vim 深似海， 从此鼠标是路人 "**。


# 基本操作 ( 移动、写入、保存等等 )

打开 Vim ：

```
vim
```
打开某个文件名, 即:

```
vim 文件名
```

*  i ： 插入文本

> 注意看左下角有一个 "INSERT" ， 说明我们处于 Insert Mode ( 插入模式下 )。 "Esc",  退出回到 交互模式 。

*  移动 : h、j、k、l ( 上下左右移动 )

在 Vim 交互模式下， 可以  在文本中移动光标， 如下表：


|按键|作用|
|---|---|
|h|向左移动一个字符|
|j|向下移动一个字符|
|k|向上移动一个字符|
|l|向右移动一个字符|


*  0 和 $ ： 移动到行首和行末

>在交互式模式下：
为了将光标定位到一行的开始位置，我们只需要按下数字键 0 即可。当然了，键盘上的 “Home” 键也有相同效果。但是我们还是建议用 0 键，毕竟不用隔那么老远去按 Home 键。

>为了将光标定位到一行的末尾，我们只需要按下美元符号键 $ 即可。 当然了，键盘上的 End 键也有相同效果。但是我们还是建议用 $ 键， 毕竟不用隔那么老远去按 End 键。

*  **w** ：一个单词一个单词移动

*  **:w** ：保存文件。 ( 后面可跟自己命名的文件 )。

*  **:q** ： 退出。  也可以强行退出  **:q!** 。

*  **:wq** ： 保存后退出。

# 标准操作 ( 复制、粘贴、撤销等等 )

在交互模式下做大量的操作， 如果你不是交互模式， 按 ESC 。

* 删除字符 ：

在交互式模式下， 将光标定位到你所想删除的字符上， 按下字母 x ( 小写 )， 你会发现这个字符会被删除。 效果和 Backspace 一样。


也可以一次性删除多个字符， 从管标开始往后删除 n 个字符， 就先按下键盘的数字， 然后再按下 x 。

* d : 删除单词、行等等。 
虽然是删除， 但是删除的内存会被缓存到内存， 相当于 " 剪切 "。

> **dd**：删除行， ( 连续按两次来删除光标所在的那一行 )， 也可以和数字配合使用删除多行。
> 
**dw** ： 删除一个单词， 将光标置于一个单词的首字母处， 然后按下 dw ，如果光标放在某个字符上，则只会删除当前字符到下一个空格前的所以字符。 也可以删除多个单词　( 如 3dw / d3w )。
>
**d0** 和 **d$** ：删除行首或行末 : 按下 d 键， 再加 0 键， 就会删除从光标处到行首的所有字符。按下 d 键， 再加 $ 键， 就会删除从光标处到行末的所有字符。

*  yy : 
复制到内存中按两次y会把光标所在行复制到内存中。和dd类似，dd用于“剪切”光标所在行到内存中，而yy是“复制”。yw则会复制一个单词，y$则是复制从光标所在处到行末的所有字符，y0是复制从光标所在处到行首的所有字符。

*  p : 粘贴如果你之前用dd来剪切过一行，或者用yy来复制过一行，或者是同类操作（比如y$, dw, y0, d0，等等），那么可以使用p键来粘贴这些内容。

> 注意 : 用 p 来粘贴时， 内容会被粘贴到光标之后去。

如果你用 yy 复制了一行， 再用 p 来粘贴， 那么需要在 p 前面加上次数。例如 7p ， 表示粘贴 7 次。

*  r : 替换一个字符

在交互式模式下， 把光标放置到想要替换的字符上， 按下 r 键， 接着输入想要替换的字符。 例如 rs 替换当前的字符为 s 。 如果使用大写 R , 那么就是切换到替换模式了， 左下角会显示 **"REPLACE"**。

*  u : 撤销操作
如果要撤销最近的修改， 只需要按下 u 键， 同理， 如果要撤销最近四次修改， 可以按下 4 ， 再按下 u 。

> Vim 中数字 + 指令是很通用的方式。


为了取消撤销，也就是重做之前的修改， 只需要按下 **Ctrl + r** 键。

*  g : 跳到指定行

一个文件中都有一个行号，类似于一个坐标。在 Vim 中， 我们可以看到在右下方有这样的字样： **7,1**； 7 表示 7 行， 1 表示 1列。

> 要跳到最后一行： 按下大写的 G ( 大写的 G ，shift + g )

要跳到第一行： 按下 gg ( 两次 g 键 )

跳转到指定行： 行号 + G 或者 行号 + gg


# 高级操作 ( 分屏、合并、查找等等 )

例如 ： 合并、查找、替换、分屏等等

这些操作在交互模式下进行。

## / : 查找

如果你按下 **/** ( 斜杠 )， 那么就进入了查找模式。

这时， 你会在左下方看到一个斜杠符号， 而且光标会转到斜杠右边， 意思是让你输入要查找的字符串。

此时输入你要查找的字符串， 然后按下回车， 光标就会转到文中下一个查找到的匹配处； 若果字符串不存在， 那么会显示 **" Pattern not found "** 。



如果要查找下一个匹配项，只需要按n键。如果要反向查找，需要按 N（ 大写的 n，Shift + n ）。

用斜杠来进行的查找是从当前光标处开始。 如果你要从文件最开始处查找，那么将斜杠 / 替换为问号 ？ 即可，其他功能是一样的。



## : s 查找替换

要实现字符串替换， 有好几种方法。

最简单的是: 
```
:s/旧字符串/新字符串
```
但只会替换光标所在行匹配的第一个人字符串


列出所有实现查找替换的方法：

| 方法 | 效果 |
|--------|--------|
|:s/旧字符串/新字符串 | 替换光标所在行的第一个匹配的字符串 |
|:s/旧字符串/新字符串/g | 替换光标所在行的所有匹配的字符串 |
|:#,#s/旧字符串/新字符串/g | 替换文件中第 # 行到第 # 行所有匹配的字符串 |
|:%s/旧字符串/新字符串/g | 替换文件中所有匹配的字符串 ( 应该是最常用的 ) |


## : r :合并文件

可以用
```
:r
```
在光标处插入一个文件的内容。例如：

:r 另一个文件名

可以使用 Tab 键来补全另一个文件的路径。

## 分屏

Vim 可以分屏， 可以同时打开好几个文件。

分屏之后， 屏幕的每一块被成为 viewprot 。"视口"

*  **:sp** 横向分屏
:sp 就可以把屏幕分成两块， ( 默认是打开的同一文件 )  :sp + 文件名可以打开另一个文件，( 文件路径名可以 Tab 补全 )

*  **:vsp** 垂直分屏  ( 同上 )

### 分屏模式下主要的快捷键

分屏模式下实用的快捷键：

| 操作 | 效果 |
|--------|-------|
|Ctrl + w 再按 Ctrl + w | 从一个 viewport 移动到另一个 viewport |
|Ctrl + w 然后按 h | 移动光标到左边的 viewport |
|Ctrl + w 然后按 j | 移动光标到下边的 viewport |
|Ctrl + w 然后按 k | 移动光标到上边的 viewport |
|Ctrl + w 然后按 l | 移动光标到右边的 viewport |
|Ctrl + w 然后按 + | 扩大当前的 viewport |
|Ctrl + w 然后按 - | 缩小当前的 viewport |
|Ctrl + w 然后按 = |重新均匀分配各个 viewport 的占比 |
|Ctrl + w 然后按 r | 调换各个 viewport 的位置 。用 R 的话是反向调换 |
|Ctrl + w 然后按 q 或者按 c | 关闭当前 viewport |
|Ctrl + o 或者 only  | 只保留当前所在的 viewport ， 关闭其他的 viewport |


## ：！ 运行外部命令

在 Vim 中可以运行一些终端命令。 只要先输入 
```
:!
```
然后接命令名称。例如: 
```
:!ls
```
就是 Vim 打开的文件所在目录运行 ls 命令， 就会列出当前目录包含的文件。

# 配置 Vim 

可以采用两种方式来配置 Vim ：

*  激活或不激活选项参数： 参考[选项参数完整文档](http://vimdoc.sourceforge.net/htmldoc/)  ( 科学上网 ) 不懂的上网搜索

*  安装插件。 参考 [Vim 官方插件页](http://www.vim.org/scripts/script_search_results.php?keywords=&script_type=&order_by=downloads&direction=descending&search=search)

## 参数选项功能

在Vim被启动后，我们可以运行一些指令来激活一些选项参数。但是这些选项参数的配置在你退出Vim时会被忘记。如果你希望你所做的配置是永久性的，那么需要在你的家目录创建一个Vim的配置文件： **.vimrc**

## 以命令模式激活选项参数

激活选项参数:   
```
:set 选项名```

不激活选项参数:  
```
:set no选项名```

选项参数需要被指定值:  
```
:set 选项名=数值```

了解选项参数状态，输入: 
```
:set 选项名?```


## 在配置文件中配置选项参数

目前在我们的用户家目录还没有 **.vimrc** ( 注意前面有一个点 **.** ，表示是隐藏文件 ), 这个是 Vim 的配置文件。但是在 /etc/vim 目录中有一个文件叫做 vimrc （ 注意前面没有一点 . ）。


把 /etc/vim 目录下的 vimrc 拷贝到家目录中， 重命名为 .vimrc 如下：

```
cp /etc/vim/vimrc   ~/.vimrc
```

然后用 vim 打开：

```
vim  .vimrc
```

*  syntax : 配置语法高量

首先激活 语法高亮 这个选项参数， Vim 支持很多种语言编程语言类型的文件， 例如 C、C++、Python、Java、Ruby、Bash、Perl等等。要激活语法高亮只需要保证：

```
syntax on
```

> 注意修改了 .vimrc 这个配置文件后， 需要保存此文件， 退出，在重新运行。



*  background  :  背景色

设置背景色:  开启黑色背景色选项

```
set background=dark
```

*  number : 显示行号
Vim 中， 要在文件中显示行号 ( 行号在每一行的左边 )， 需要：

```
set number
```
*    showcmd : 显示当前命令

Vim 中输入命令时， 有时 ( 在交互模式下 ) 不能看到自己输入的命令。那么想要看到自己输入的命令需要设置 ：

```
set showcmd
```

*  ignorecase : 在查找忽略大小写

Vim 默认情况下是区分大小写的， 例如 搜索 "mark" 的时候， 就搜不到 "MARK"、"Mark"等等，那么在搜索时忽略大小写需要这样设置 ：

```
set ignorecase
```

*  mouse : 鼠标支持

激活鼠标选项，即使在终端也可以使用鼠标 只要 :

```
set mouse=a
```

网上也有很多高手配置的 .vimrc ， 可供下载， 然后只需稍加修改就可以成为自己的 Vim 配置了。



---














