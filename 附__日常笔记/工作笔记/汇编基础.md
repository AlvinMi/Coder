* DOXBox: http://www.dosbox.com/download.php?main=1

# ARM 汇编指令集

（汇编）指令：   是机器码的助记符，经过汇编器编译后，由 CPU 执行。

（汇编）伪指令：用来指导指令执行，是汇编器的产物，最终不会生成机器码。

## 有两种不同风格的 ARM 指令
* ARM 官方的 ARM 汇编风格：指令一般用大写，Windows 中的 IDE 开发环境。

* GNU 风格的 ARM 汇编：指令一般用小写。


# ARM 汇编的特点

## 01 LDR/STR 架构
* ARM 采用 RISC 架构，CPU 本身不能直接读取内存，而需要先将内存中内容加载入 CPU 中通用寄存器中才能被 CPU 处理。
* ldr（load register）指令将内存内容加载入通用寄存器。
* str（store register）指令将寄存器内容存入内存空间中。
* ldr/str 组合用来实现 ARM CPU 和内存数据交换。

## 02 至此 8 种寻址方式

* 1. 寄存器寻址 mov r1, r2。
* 2. 立即 (立即数) 寻址 mov r0, #0xFF00。
* 3. 寄存器移位寻址 mov r0, r1, lsl #3。
* 4. 寄存器间接寻址 ldr r1, [r2] 表示内存，内存地址存在 r2 这个寄存器中，把内存地址里的值给 r1。
* 5. 基址变址寻址 ldr r1, [r2, #4] 内存地址在 r2+4 里面。
* 6. 多寄存器寻址 ldmia r1!, {r2-r7, r12} 一次访问多个寄存器。
* 7. 堆栈寻址 stmfd sp!, {r2-r7, lr}。
* 8. 相对寻址 beq flag。

## 03 数据传输与跳转指令详解

数据传输指令 mov mvn
算术指令 add sub rsb adc sbc rsc
逻辑指令 and orr eor bic
比较指令 cmp cmn tst teq
乘法指令 mvl mla umull umlal smull smlal
前导零计数 clz

# Thumb （ARM 体系结构的指令集）

是 ARM 指令集的一个子集。Thumb 是 ARM 体系结构中一种 16 位的指令集。Thumb 指令体系并不完整，只支持通用功能，必要时仍需要使用 ARM 指令，如进入异常时。其指令的格式与使用方式与 ARM 指令集类似。

Thumb 指令集由数据处理指令、跳转指令、Load/Store 指令和软件中断指令 4 大类构成。

在编写 Thumb 指令时，先要使用伪指令 CODE16 声明，编写 ARM 指令时，则可使用 CODE32 伪指令声明：

* 1、Thumb 指令集没有协处理器指令、信号量指令、以及访问 CPSR 或 SPSR 的指令，没有乘加指令及 64 位乘法指令等，且指令的第二操作数受到限制

* 2、大多数的 Thumb 数据处理指令采用 2 地址格式；

* 3、除了跳转指令 B 有条件执行功能之外，其他指令均为无条件执行，而且分支指令的跳转范围有更多限制；

* 4、数据处理指令是对通用寄存器进行操作，在大多数情况下，操作的结果放入其中一个操作数寄存器中，而不是放入第 3 个寄存器中；访问寄存器 R8~R15 受到一定的限制，除 MOV、ADD 指令访问 R8~R15 外，其他数据处理指令总是更新 CPSR 中 ALU 状态标志，访问寄存器 R8~R15 的 Thumb 数据处理指令不能更新 CPSR 中的 ALU 状态指示。

* 5、Thumb 状态下，单寄存器加载和存储指令只能访问寄存器 R0~R7；

* 6、LDM、STM 指令可以将任何范围为 R0~R7 的寄存器子集加载或存储；

* 7、PUSH、POP 指令使用栈寄存器 R13 作为基址堆栈操作。

## Thumb 指令与 ARM 指令的区别

* 1. 分支指令: 跳转的范围小, 除 B 指令外, 都是无条件跳转.

* 2. 数据处理指令: Thumb 指令只有 2 个操作数, 而 ARM 指令是 3 个操作数.

* 3. 单寄存器加载存储指令: Thumb 指令只能访问 R0~R7.

* 4. 多寄存器加载存储指令: Thumb 指令只能访问 R0~R7 的子集.

* 5.Thumb 特有指令: PUSH 和 POP 作用于 R13.
